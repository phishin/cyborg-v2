<script setup>import { ref, computed, onMounted, onUnmounted, watch } from "vue";import FrequentlyAskedQuestions from "~/components/homepage/FrequentlyAskedQuestions.vue";import ContactSupportForm from "~/components/homepage/ContactSupportForm.vue";import allSuffixes from "~/components/CreationFlow/all-suffixes.json";import { useLogoStore } from "~/stores/logoStores";const logoStore = useLogoStore();// Bind global fields via computed propertiesconst businessNameInitials = computed({  get: () => logoStore.businessNameInitials,  set: (val) => { logoStore.businessNameInitials = val; }});const fullBusinessName = computed({  get: () => logoStore.fullBusinessName,  set: (val) => { logoStore.fullBusinessName = val; }});const businessCategory = computed({  get: () => logoStore.businessCategory,  set: (val) => { logoStore.businessCategory = val; }});const selectedLogoStyle = computed({  get: () => logoStore.selectedLogoStyle,  set: (val) => { logoStore.selectedLogoStyle = val; }});const selectedSuffix = computed({  get: () => logoStore.selectedSuffix,  set: (val) => { logoStore.selectedSuffix = val; }});// Advance only if either full business name or initials is providedconst isValidSelection = computed(() => {  return !!(logoStore.businessNameInitials || logoStore.fullBusinessName);});// Watchers: when one field is updated, clear the otherwatch(fullBusinessName, (newVal) => {  if (newVal) {    logoStore.businessNameInitials = null;  }});watch(businessNameInitials, (newVal) => {  if (newVal) {    logoStore.fullBusinessName = null;  }});// Suffix selection dataconst showDropdown = ref(false);const showSuffixTooltip = ref(false);const suffixNames = ref(allSuffixes);// Select suffix and close dropdownconst selectSuffix = (item) => {  selectedSuffix.value = item.name;  showDropdown.value = false;};// Manage dropdown visibilityconst hideDropdown = () => {  setTimeout(() => {    showDropdown.value = false;  }, 100);};const toggleDropdown = () => {  showDropdown.value = !showDropdown.value;};const toggleSuffixTooltip = () => {  showSuffixTooltip.value = !showSuffixTooltip.value;};const highlightedIndex = ref(-1); // For keyboard navigation// Handle keyboard navigation for the suffix dropdownconst handleKeyDown = (event) => {  if (!showDropdown.value || suffixNames.value.length === 0) return;  if (event.key === "ArrowDown") {    event.preventDefault();    highlightedIndex.value = (highlightedIndex.value + 1) % suffixNames.value.length;  } else if (event.key === "ArrowUp") {    event.preventDefault();    highlightedIndex.value = (highlightedIndex.value - 1 + suffixNames.value.length) % suffixNames.value.length;  } else if (event.key === "Enter" && highlightedIndex.value >= 0) {    event.preventDefault();    selectSuffix(suffixNames.value[highlightedIndex.value]);  }};// Step navigation: use store actions or update the store's creationStep directlyconst advanceCreationStep = () => {  // For example, call the store's nextStep action  logoStore.nextStep();};const previousCreationStep = () => {  logoStore.previousStep();};onMounted(() => {  // Set this step as 3  logoStore.creationStep = 3;  window.addEventListener("keydown", handleKeyDown);});onUnmounted(() => {  window.removeEventListener("keydown", handleKeyDown);});</script><template>  <section class="creation-step step-3 w-full relative flex flex-col justify-start items-start font-primary mt-[69px] md:mt-[80px] lg:mt-[95px]">    <div class="creation-flow-content w-full relative">      <!-- Top Prev/Next Buttons on Desktop -->      <div class="top-desktop-buttons relative flex-row justify-between hidden lg:flex pt-[66px] mx-auto w-[90%] site-container">        <!-- Previous step -->        <button @click="previousCreationStep"                class="previous-step-button flex flex-row gap-[12px] py-[25px] px-[24px] max-w-fit border-[4px] border-black uppercase font-black text-[18px] leading-[2px] tracking-[1px] text-neutral-700 items-center h-[68px] transition transition-fast hover:bg-black hover:text-white group">          <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">            <path fill-rule="evenodd" clip-rule="evenodd"                  class="group-hover:fill-white transition transition-fast"                  d="M6.65829 11.4917C6.20268 11.9473 5.46399 11.9473 5.00838 11.4917L0.341709 6.82504C-0.113903 6.36943 -0.113903 5.63074 0.341709 5.17512L5.00838 0.508457C5.46399 0.052845 6.20268 0.052845 6.65829 0.508457C7.1139 0.964069 7.1139 1.70276 6.65829 2.15837L3.98325 4.83342L12.8333 4.83341C13.4777 4.83341 14 5.35575 14 6.00008C14 6.64441 13.4777 7.16675 12.8333 7.16675H3.98325L6.65829 9.84179C7.1139 10.2974 7.1139 11.0361 6.65829 11.4917Z"                  fill="#1F2937"/>          </svg>          Back One Step        </button>        <!-- Next step -->        <button @click="advanceCreationStep"                class="next-step-button flex flex-row gap-[12px] py-[25px] px-[24px] max-w-fit uppercase font-black text-[18px] leading-[1] tracking-[2px] text-white bg-brand-200 items-center h-[68px] transition transition-fast"                :class="isValidSelection ? 'opacity-100 pointer-events-auto hover:bg-black' : 'opacity-50 pointer-events-none'">          Continue          <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">            <path fill-rule="evenodd" clip-rule="evenodd"                  d="M7.34171 0.508457C7.79732 0.0528452 8.53601 0.0528451 8.99162 0.508457L13.6583 5.17512C14.1139 5.63074 14.1139 6.36943 13.6583 6.82504L8.99162 11.4917C8.53601 11.9473 7.79732 11.9473 7.34171 11.4917C6.8861 11.0361 6.8861 10.2974 7.34171 9.84179L10.0168 7.16675L1.16667 7.16675C0.522335 7.16675 -2.81646e-08 6.64441 0 6.00008C2.81647e-08 5.35575 0.522335 4.83342 1.16667 4.83342H10.0168L7.34171 2.15837C6.8861 1.70276 6.8861 0.964069 7.34171 0.508457Z"                  fill="white"/>          </svg>        </button>      </div>      <!-- Step Three Content -->      <div class="step-content site-container pt-[34px] lg:pt-[64px]">        <h1 class="block relative text-black font-bold text-[20px] md:text-[26px] lg:text-[32px] leading-[1.2]">          <span v-if="selectedLogoStyle === 'Full Business Name'">            What is your full business name?          </span>          <span v-else-if="selectedLogoStyle === 'Initials'">            What are your business initials?          </span>          <span v-else>            Select business initials          </span>        </h1>        <h2 class="block relative text-black font-normal text-[18px] md:text-[20px] lg:text-[24px] pt-[20px] leading-[1.35]">          <span v-if="selectedLogoStyle === 'Full Business Name'">            This is the name that will appear prominently on your logo.          </span>          <span v-else-if="selectedLogoStyle === 'Initials'">            These are the initials that will appear prominently on your logo.          </span>        </h2>        <!-- Input Fields -->        <div class="business-info-fields w-full relative grid grid-cols-1 md:grid-cols-2 lg:grid-cols-12 md:gap-x-[25px] gap-y-[24px] pt-[30px]" v-if="selectedLogoStyle">          <!-- For Full Business Name -->          <div class="info-item w-full h-full relative flex flex-col lg:col-span-8" v-if="selectedLogoStyle === 'Full Business Name'">            <label for="full_business_name" class="block relative font-bold text-black text-[12px] md:text-[16px] pb-[3px] lg:pb-[5px] leading-[1.1]">Name</label>            <input                v-model="fullBusinessName"                name="full_business_name"                type="text"                class="block md:mt-auto w-full relative border-[3px] border-neutral-200 py-[23px] px-[18px] text-[16px]"                placeholder="Enter the full name of your business">          </div>          <!-- For Business Initials -->          <div class="info-item w-full h-full relative flex flex-col lg:col-span-8" v-if="selectedLogoStyle === 'Initials'">            <label for="business_name_initials" class="block relative font-bold text-black text-[12px] md:text-[16px] pb-[3px] lg:pb-[5px] leading-[1.1]">Name (Initials)</label>            <input                v-model="businessNameInitials"                name="business_name_initials"                type="text"                class="block md:mt-auto w-full relative border-[3px] border-neutral-200 py-[23px] px-[18px] text-[16px]"                placeholder="Type your business initials">          </div>          <!-- Suffix Field -->          <div class="info-item w-full h-full relative flex flex-col lg:col-span-4">            <div class="input-field-wrapper w-full h-full relative">              <label for="suffix" class="flex flex-row justify-start items-center relative font-bold text-black text-[12px] md:text-[16px] pb-[3px] lg:pb-[5px] leading-[1.1]">                Suffix (LLC, Inc.)                <span class="tooltip-trigger relative pl-[5px] cursor-help" @click.prevent="toggleSuffixTooltip">                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">                      <path d="M10.7778 13.1111H10V10H9.22222M10 6.88889H10.0078M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="#1F2937" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>                    </svg>                  </span>              </label>              <input                  type="text"                  :value="selectedSuffix"                  @focusout="hideDropdown"                  placeholder="Select suffix (optional)"                  @click.prevent="toggleDropdown"                  readonly                  class="search-input-field border-[3px] border-neutral-200 text-[16px] px-[18px] py-[23px] relative w-full cursor-text"              />              <!-- Dropdown for suffix selection -->              <ul v-if="showDropdown" class="dropdown-list absolute w-full bg-white border border-gray-300 max-h-48 overflow-y-auto z-10">                <li                    v-for="(suffix, index) in suffixNames"                    :key="suffix.id"                    @mousedown.prevent="selectSuffix(suffix)"                    :class="['dropdown-item text-black text-[16px] md:text-[18px] lg:text-[20px] font-medium lg:font-semibold py-[17px] px-[20px] lg:py-[12px] cursor-pointer transition transition-fast', { 'bg-neutral-100 text-brand-electric-blue': index === highlightedIndex }]">                  {{ suffix.name }}                </li>              </ul>            </div>            <transition name="fade">              <div class="tooltip-content w-full flex flex-col justify-center absolute top-[34px] left-0 right-0 z-[1]" v-show="showSuffixTooltip">                <div class="tooltip-carat absolute top-[-8px] left-[104px]">                  <svg width="16" height="8" viewBox="0 0 16 8" fill="none" xmlns="http://www.w3.org/2000/svg">                    <path d="M8 0L16 8L0 8L8 0Z" fill="#111827"/>                  </svg>                </div>                <div class="tooltip-content-wrapper w-full h-full bg-neutral-900/90 rounded-[8px] p-[16px] pt-[40px]">                  <div class="tooltip-close absolute top-[16px] right-[16px] cursor-pointer" @click.prevent="toggleSuffixTooltip">                    <svg width="12" height="12" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">                      <path d="M1 9L9 1M1 1L9 9" stroke="white" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>                    </svg>                  </div>                  <p class="text-white block text-[12px] leading-[20px] font-normal">                    Choose a suffix that legally describes your business structure, such as LLC, Inc., or Corp. If your business does not have a formal suffix, you can leave this optional field blank.                  </p>                </div>              </div>            </transition>          </div>          <!-- Business Category Field -->          <div class="info-item w-full h-full relative flex flex-col lg:col-span-8">            <label for="business_category" class="block relative font-bold text-black text-[12px] md:text-[16px] pb-[3px] lg:pb-[5px] leading-[1.1]">Business Category</label>            <input                v-model="businessCategory"                name="business_category"                type="text"                class="block w-full relative border-[3px] border-neutral-200 py-[23px] px-[18px]"                placeholder="(Optional) ex. Services, Management, Construction"                required>          </div>        </div>      </div>      <!-- Mobile Advance Button -->      <div class="fixed bottom-0 left-0 top-auto right-0 mt-[40px] py-[16px] bg-white/95 w-full bottom-button advance-button flex flex-col justify-center items-center lg:hidden">        <button @click.prevent="advanceCreationStep"                class="advance-button w-full max-w-fit mx-auto relative bg-brand-200 text-white font-bold flex flex-row items-center justify-between uppercase gap-[12px] py-[16px] px-[17px] transition transition-fast"                :class="isValidSelection ? 'opacity-100 pointer-events-auto' : 'opacity-50 pointer-events-none'">          Continue          <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.34171 0.508457C7.79732 0.0528452 8.53601 0.0528451 8.99162 0.508457L13.6583 5.17512C14.1139 5.63074 14.1139 6.36943 13.6583 6.82504L8.99162 11.4917C8.53601 11.9473 7.79732 11.9473 7.34171 11.4917C6.8861 11.0361 6.8861 10.2974 7.34171 9.84179L10.0168 7.16675L1.16667 7.16675C0.522335 7.16675 -2.81646e-08 6.64441 0 6.00008C2.81647e-08 5.35575 0.522335 4.83342 1.16667 4.83342H10.0168L7.34171 2.15837C6.8861 1.70276 6.8861 0.964069 7.34171 0.508457Z" fill="white"/>          </svg>        </button>      </div>    </div>    <div class="bottom-content w-full relative lg:mt-[290px] hidden lg:block">      <frequently-asked-questions></frequently-asked-questions>      <contact-support-form></contact-support-form>    </div>  </section></template><style scoped lang="scss">.fade-enter-active,.fade-leave-active {  transition: opacity 0.5s ease;}.fade-enter-from,.fade-leave-to {  opacity: 0;}input {  transition: .25s all;  -webkit-transition: .25s all;  &:focus,  &:focus-visible,  &:active {    border: 3px solid #00A5FD;    transition: .25s all;    -webkit-transition: .25s all;    outline: none;  }}/* Optional styling for dropdown */.dropdown-list {  @media only screen and (min-width: 1024px) {    box-shadow: 0 5px 12px 3px rgba(0, 0, 0, 0.10);  }}.dropdown-item:hover {  background-color: #e2e8f0;  color: #00A5FD;}.search-input-field {  transition: border-color 0.3s, box-shadow 0.3s;  &.focused {    //padding-top: 32px;    //padding-bottom: 17px;  }  &:focus,  &:active {    border: 3px solid #00A5FD;    transition: .25s all;    -webkit-transition: .25s all;    outline: none;  }}.business-info-fields {  input::placeholder {    color: #4B5563;    font-weight: 400;    font-size: 12px;    line-height: 1.2;  }}</style>